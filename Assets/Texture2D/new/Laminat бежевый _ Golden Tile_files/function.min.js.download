$(document).ready(function(){if(window.location.hash!=""){var tab=window.location.hash;tab=tab.substring(0,tab.length-4);$("[data-toggle='tab'][href='"+tab+"']").trigger("click");}$('a[data-toggle="tab"]').on('shown.bs.tab',function(e){window.location.hash=$(this).attr("href")+"-tab";});$(".js_ajax").on("submit",function(){var _form=$(this);var _url=window.location.href.split("/");var data=$(this).serialize();$.ajax({url:_url.slice(0,4).join("/")+"/",dataType:"json",type:"POST",data:data,success:function(res){if(res.status==1){$('.js-modal-parnter').removeClass('open');$('.js-modal-consent').find('p').text(res.content);$('.js-modal-consent').addClass('open');}}});return false;});if(getCookie('country')==undefined){$(".js_country").removeAttr("style");}$("#chose_country").on("change",function(){var _url=window.location.href.split("/");var country=$(this).val();$.ajax({url:_url.slice(0,4).join("/")+"/",dataType:"json",type:"POST",data:"ajax=country&country="+country,success:function(res){if(res.status==1){window.location.href=res.content;}}});});$(".js_ajaxSearch").on("keyup",function(){var _form=$(this);var _url=window.location.href.split("/");var data=_form.find('[name="search"]').val();var type=_form.find('[name="type"]').val();if(data.length>2){$.ajax({url:_url.slice(0,4).join("/")+"/",dataType:"json",type:"POST",data:"ajax=search&search="+data+"&type="+type,success:function(res){if(res.status==1){$("#searchResult").html(res.content);var contentLength=res.content.length;if(contentLength>0){$("#searchResult").removeAttr("style");$("#searchResult").attr("style","display:block;");}else{$("#searchResult").removeAttr("style");$("#searchResult").attr("style","display:none;");}}else{$("#searchResult").removeAttr("style");$("#searchResult").attr("style","display:none;");$("#searchResult").html('');}}});}return false;});if(parseFloat($('.js_cart_count').text())>0){$('.js_cart_menu').removeAttr('style');$('.js_cart-empty').removeClass('cart-empty');}$(document).on("click",".js_changePassword",function(){$('[name="account[password]"]').removeAttr("readonly");return false;});$(document).on("click",".js_add_address",function(){var button=$(this);var _url=window.location.href.split("/");var buttonRemoveAddr=$('.js-removeAddr');$.ajax({url:_url.slice(0,4).join("/")+"/",dataType:"json",type:"GET",data:"ajax=addaccountaddress&index="+$("input").length,success:function(res){if(res.status==1){button.parent().before(res.content);$('input[data-validate="phone"]').unmask().mask("+38(999) 999 99 99");buttonRemoveAddr.show();}}});return false;});if($('.account-form').find(".input-group-wrapper").length==1){$('.js-removeAddr').hide();}$(document).on("click",".js-removeAddr",function(event){console.log($('.account-form').find(".input-group-wrapper").length);if($('.account-form').find(".input-group-wrapper").length<3){$(this).parents('.input-group-wrapper').remove();$('.js-removeAddr').hide();}else{$(this).parents('.input-group-wrapper').remove();}});$('#collection li').on('click',function(){var _id=$(this).prevAll().length;var _did=$(this).parent().parent().find('option:eq('+_id+')').val();var _url=window.location.href.split("/");$.ajax({url:_url.slice(0,4).join("/")+"/",dataType:"json",type:"GET",data:"ajax=downloadcollection&did="+_did,success:function(res){if(res.status==1){$(".js_collection").find('ul').html(res.content);$(".js_collection").removeAttr('style');}}});return false;});$('#standarts li').on('click',function(){var _id=$(this).prevAll().length;var _did=$(this).parent().parent().find('option:eq('+_id+')').val();var _url=window.location.href.split("/");$.ajax({url:_url.slice(0,4).join("/")+"/",dataType:"json",type:"GET",data:"ajax=downloadstandarts&did="+_did,success:function(res){if(res.status==1){$(".js_standarts").find('ul').html(res.content);$(".js_standarts").removeAttr('style');}}});return false;});$(document).on("click","[data-filter]",function(){generateFilterUrl($(this).attr("data-filter"),$(this).attr("data-type"));return false;});$('.select-wrapper li').on('click',function(){var _id=$(this).prevAll().length;var _type=$(this).parent().parent().find('option:eq('+_id+')').attr('data-type');var _filter=$(this).parent().parent().find('option:eq('+_id+')').attr('data-filter');if(_filter){generateFilterUrl(_filter,_type);}return false;});$(document).on("click","[data-price]",function(){var priceMin=parseFloat($("[name*='min']").val());var priceMax=parseFloat($("[name*='max']").val());generateFilterUrl('price='+priceMin+'-'+priceMax);return false;});$(document).on("click","[data-jsfilter]",function(){var filterUrl=generateJsFilterUrl($('.js-variation').attr('data-url'),$(this).attr("data-jsfilter"),$(this).attr("data-type"));var did=$('.js-variation').attr('id').split("-");did=parseInt(did[did.length-1]);$.ajax({url:filterUrl,dataType:"json",type:"POST",data:"ajax=filters&did="+did,success:function(res){if(res.status==1){$('.js-size').html(res.filterSize);$('.js-color').html(res.filterColor);$('.js-thickness').html(res.filterThickness);$('.js-products').html(res.products);}}});$('.js-variation').attr('data-url',filterUrl);return false;});});function generateFilterUrl(filter,type){if(type===undefined){type='checkbox';}var newFilters=[];var searchFilter=true;var regex=/\/f\/(.*)/i;var _url=window.location.pathname;var _get=window.location.search;var _get=_get.replace(/\?/g,'').split("&");var _gts=[];for(var j=0;j<_get.length;j++){var _g=_get[j].split("=");if(_g[0]!='p'){_gts.push(_get[j]);}}var _get=_gts.join('&');var filter=filter.split("=");_filterUrl=_url.match(regex);if(_filterUrl){_filterArr=_filterUrl[0].split('/');_filters=_filterArr[2].split(';');if(filter[0]=='country'){_filters=[];}for(var i=0;i<_filters.length;i++){var _filter=_filters[i].split("=");if(filter[0]==_filter[0]){searchFilter=false;_values=_filter[1].split(',');_index=_values.indexOf(filter[1]);if(_index!=-1){_values.splice(_index,1);}else{_values.push(filter[1]);}if(type=='radio'){_values=[];_values.push(filter[1]);}if(filter[0]=='price'){_values=[];_values.push(filter[1]);}if(filter[1].length==0){_values=[];}if(_values.length>0){_filter[1]=$.unique(_values).join(',');_filters[i]=_filter.join('=');newFilters.push(_filters[i]);}}else{newFilters.push(_filters[i]);}}if(searchFilter){newFilters.push(filter.join('='));}if(newFilters.length>0){var _newUrl=_url.slice(0,-_filterUrl[0].length)+'/f/'+newFilters.join(';')+'/';}else{var _newUrl=_url.slice(0,-_filterUrl[0].length)+'/';}}else{if(filter[1].length>0){var _newUrl=_url+'f/'+filter[0]+'='+filter[1]+'/';}else{var _newUrl=_url;}}if(_get.length>0){window.location.href=_newUrl+'?'+_get;}else{window.location.href=_newUrl;}}function generateJsFilterUrl(_url,filter,type){if(type===undefined){type='checkbox';}var newFilters=[];var searchFilter=true;var regex=/\/f\/(.*)/i;var filter=filter.split("=");_filterUrl=_url.match(regex);if(_filterUrl){_filterArr=_filterUrl[0].split('/');_filters=_filterArr[2].split(';');for(var i=0;i<_filters.length;i++){var _filter=_filters[i].split("=");if(filter[0]==_filter[0]){searchFilter=false;_values=_filter[1].split(',');_index=_values.indexOf(filter[1]);if(_index!=-1){_values.splice(_index,1);}else{_values.push(filter[1]);}if(type=='radio'){_values=[];_values.push(filter[1]);}if(filter[0]=='price'){_values=[];_values.push(filter[1]);}if(filter[1].length==0){_values=[];}if(_values.length>0){_filter[1]=$.unique(_values).join(',');_filters[i]=_filter.join('=');newFilters.push(_filters[i]);}}else{newFilters.push(_filters[i]);}}if(searchFilter){newFilters.push(filter.join('='));}if(newFilters.length>0){var _newUrl=_url.slice(0,-_filterUrl[0].length)+'/f/'+newFilters.join(';')+'/';}else{var _newUrl=_url.slice(0,-_filterUrl[0].length)+'/';}}else{if(filter[1].length>0){var _newUrl=_url+'f/'+filter[0]+'='+filter[1]+'/';}else{var _newUrl=_url;}}return _newUrl;}function priceFormat(n){return n.toFixed(2).replace(/./g,function(c,i,a){return i&&c!=="."&&((a.length-i)%3===0)?"&nbsp;"+c:c;});}function setAgreeCountry(country){var expire=new Date();expire=new Date(expire.getTime()+31536000);document.cookie="country="+country+"; path=/; expires="+expire;}function getCookie(name){var matches=document.cookie.match(new RegExp("(?:^|; )"+name.replace(/([\.$?*|{}\(\)\[\]\\\/\+^])/g,'\\$1')+"=([^;]*)"));return matches?decodeURIComponent(matches[1]):undefined;}function FindLeftWindowBoundry(){if(window.screenLeft){return window.screenLeft;}if(window.screenX){return window.screenX;}return 0;}function FindTopWindowBoundry(){if(window.screenTop){return window.screenTop;}if(window.screenY){return window.screenY;}return 0;}